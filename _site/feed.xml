<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Simple Blog (mauriziopaul)</title>
    <description>This is the site for Paul Maurizio&#39;s GitHub pages blog, discussing research at the intersection of  statistical genetics and host-pathogen interactions.
</description>
    <link>http://mauriziopaul.github.io/blog/</link>
    <atom:link href="http://mauriziopaul.github.io/blog/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Tue, 10 Nov 2015 05:06:20 -0500</pubDate>
    <lastBuildDate>Tue, 10 Nov 2015 05:06:20 -0500</lastBuildDate>
    <generator>Jekyll v2.4.0</generator>
    
      <item>
        <title>Toward the Estimation of Treatment Effects in Allele-Specific RNA-Seq</title>
        <description>&lt;p&gt;&lt;img src=&quot;/blog/images/founderSNPs.png&quot; alt=&quot;Founders&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As a starting point for learning to analyze allele-specific RNA-seq reads, we will use existing data sets from this &lt;a href=&quot;http://www.nature.com/ng/journal/v47/n4/full/ng.3222.html&quot;&gt;Nature Genetics&lt;/a&gt; article on allelic imbalance in crosses of wild-derived mice. The sequence read archive (sra) files from this study are available &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/sra?term=SRP056236&quot;&gt;here&lt;/a&gt;. We will start with WSB x PWK females, of which there are 6 files (SRR1924540, SRR1924539, SRR1924538, SRR1924535, SRR1924534, SRR1924529), and PWK x WSB females, of which there are 5 files (SRR1924516, SRR1924511, SRR1924510, SRR1924509, SRR1924508).&lt;/p&gt;

&lt;p&gt;Unlike the original study, we will attempt to analyze allelic imbalance in the absence of any inbred strains. We will also be interested in treatment effects, but will have to resort to other data sets to take a look at modeling those effects (i.e. gene induction).&lt;/p&gt;

&lt;p&gt;To begin, in order to access the sra files easily, download the &lt;a href=&quot;https://github.com/ncbi/sra-tools&quot;&gt;NCBI SRA Toolkit&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;After installing (decompressing) the archive and adding the package’s */bin/ directory to the path, the sra files can be downloaded from the command line using:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;fastq-dump -X &lt;span class=&quot;m&quot;&gt;5&lt;/span&gt; -Z SRX964397&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The files will be stored here (on a Mac OSX machine):&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;/Users/&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;username&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;/ncbi/public&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The raw data is hosted at this gene expression omnibus (GEO) &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE44555&quot;&gt;site&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;gene-expression-total-and-allele-specific-read-counts-trecase&quot;&gt;Gene Expression: Total and Allele-Specific Read Counts (TReCASE)&lt;/h2&gt;

&lt;p&gt;Read counts are modeled for both autosomal and sex chromosomes. Some genes may only have a total read count (TReC) and not an allele-specific read count (ASReC / ASE), because there is a lack of SNPs in these transcripts between founder chromosomes, or because there is not sufficient depth to calculate allele-specificity.&lt;/p&gt;

&lt;p&gt;For a given sample, $i$, and parental strain $B$, we can start by defining a binomial distribution to model the probability of the allele-specific read counts $ Y_i $ being $ n_{iB} $, given the total read counts $ Y_i $. We do this for each gene, so I am omitting any gene-specific subscript. The sample-specific probability of an allele-specific read count for a given gene is $ \pi_{iB}$, with $E(Y_i) = n_i \cdot \pi_{iB}$, and variance $Var(Y_i)=n_i \cdot \pi_{iB} (1-\pi_{iB})$:&lt;/p&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;Y_i \sim Bin(n_i, \pi_{iB})&lt;/script&gt;&lt;br /&gt;
&lt;script type=&quot;math/tex&quot;&gt;Y_i \in \{0, 1, 2, ..., n_i\}&lt;/script&gt;&lt;br /&gt;
&lt;script type=&quot;math/tex&quot;&gt;Pr(Y_i=n_{iB}; n_i, \pi_{iB}) = {n_i \choose n_{iB}} (\pi_{iB})^{n_{iB}}(1-\pi_{iB})^{n_i-n_{iB}}&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;We can then model the probability $\pi_{iB}$ of an allele-specific read count as a beta-distribution:&lt;/p&gt;

&lt;p&gt;$\pi_{iB} \sim Beta(\alpha, \beta)$.&lt;/p&gt;

&lt;p&gt;And we use a link function to estimate the genetic/POE effects on expression. Since my samples are all female, and we have no inbred mice, there is no strain effect and no sex-specific effect being modeled:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\log(\pi_{iB})=\beta_{mat}x_i&lt;/script&gt;

&lt;p&gt;where $x_i=0$ when the allele $B$ is paternal, whereas $x_i=1$ when it is maternal.&lt;/p&gt;

&lt;p&gt;However, we would like to adjust for the real-world scenario where the read counts are overdispersed, using the parameter ($\phi$):&lt;/p&gt;

&lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;Y_i \sim Bin(n_i, \pi_{iB}, \phi)&lt;/script&gt;&lt;br /&gt;
&lt;script type=&quot;math/tex&quot;&gt;Y_i \in \{0, 1, 2, ..., n_i\}&lt;/script&gt;&lt;br /&gt;
&lt;script type=&quot;math/tex&quot;&gt;Pr(Y_i=n_{iB}; n_i, \pi_{iB}) = {n_i \choose n_{iB}} (\pi_{iB})^{n_{iB}}(1-\pi_{iB})^{n_i-n_{iB}}&lt;/script&gt;&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Pr(N_B=n_B) = {n_T \choose n_B} \pi_B^{n_B}(1-\pi_B)^{n_T-n_B}&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_{BB}(n_{iB};n_i, \pi_i, \phi)={n_i \choose n_{iB}}
\frac{\prod_{k=0}^{n_{iB}-1}(\pi_i+k\phi)\pi_{k=0}^{n_i-n_{iB}-1}(1-\pi_i+k\phi)}
{\prod_{k=1}^{n_i-1}(1+k\phi)}&lt;/script&gt;

&lt;h2 id=&quot;questions&quot;&gt;Questions:&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;Should I simulate my data, and how should I do it?&lt;/li&gt;
  &lt;li&gt;How does restricting the search for DE / DAE to known imprinted genes influence my detction power?&lt;/li&gt;
  &lt;li&gt;Should I include a technical replicate, or replicates?&lt;/li&gt;
  &lt;li&gt;What about standard &lt;a href=&quot;https://www.thermofisher.com/order/catalog/product/4456740&quot;&gt;spike in&lt;/a&gt; controls? &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Note on imprinted genes: Previous lists are available at &lt;a href=&quot;http://www.geneimprint.com/&quot;&gt;Gene Imprint&lt;/a&gt;, &lt;a href=&quot;http://igc.otago.ac.nz/&quot;&gt;U Otago&lt;/a&gt;, and &lt;a href=&quot;http://www.mousebook.org/catalog.php?catalog=imprinting&quot;&gt;Mousebook&lt;/a&gt;. A new list from the Nat Gen study is available at &lt;a href=&quot;http://www.nature.com/ng/journal/v47/n4/extref/ng.3222-S2.xlsx&quot;&gt;this site&lt;/a&gt;.&lt;/p&gt;

</description>
        <pubDate>Mon, 09 Nov 2015 00:00:00 -0500</pubDate>
        <link>http://mauriziopaul.github.io/blog/rna-seq/allelic-imbalance/2015/11/09/getting-started-allele-specific-rna-seq.html</link>
        <guid isPermaLink="true">http://mauriziopaul.github.io/blog/rna-seq/allelic-imbalance/2015/11/09/getting-started-allele-specific-rna-seq.html</guid>
        
        
        <category>rna-seq</category>
        
        <category>allelic-imbalance</category>
        
      </item>
    
      <item>
        <title>Hello World!</title>
        <description>&lt;p&gt;This is my &lt;em&gt;first&lt;/em&gt; blog post. Testing-testing-1-2-3. &lt;/p&gt;

&lt;p&gt;The post is being written in &lt;a href=&quot;https://gitbookio.gitbooks.io/markdown/content/index.html&quot;&gt;markdown&lt;/a&gt; and implemented using &lt;a href=&quot;http://jekyllrb.com&quot;&gt;Jekyll&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Code snippets are easy to implement:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;lineno&quot;&gt;1&lt;/span&gt; hello &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;2&lt;/span&gt;   &lt;span class=&quot;kp&quot;&gt;sprintf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Hello, %s!&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;4&lt;/span&gt; 
&lt;span class=&quot;lineno&quot;&gt;5&lt;/span&gt; hello&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;World&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;lineno&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# prints &amp;quot;Hello, World!&amp;quot; to console.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Some resources for Jekyll: Try looking at the &lt;a href=&quot;http://jekyllrb.com/docs/home&quot;&gt;Jekyll docs&lt;/a&gt;, take a look at bugs and feature requests at &lt;a href=&quot;https://github.com/jekyll/jekyll&quot;&gt;Jekyll’s GitHub repo&lt;/a&gt;, and get answers to questions on &lt;a href=&quot;https://talk.jekyllrb.com/&quot;&gt;Jekyll Talk&lt;/a&gt;.&lt;/p&gt;

</description>
        <pubDate>Mon, 02 Nov 2015 12:58:15 -0500</pubDate>
        <link>http://mauriziopaul.github.io/blog/jekyll/2015/11/02/hello-world.html</link>
        <guid isPermaLink="true">http://mauriziopaul.github.io/blog/jekyll/2015/11/02/hello-world.html</guid>
        
        
        <category>jekyll</category>
        
      </item>
    
  </channel>
</rss>
